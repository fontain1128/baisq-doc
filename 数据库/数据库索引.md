# 索引

数据库的索引包含两种数据结构，B+树索引以及Hash索引。

# B+树

B+树是n叉排序树，每个节点有多个孩子，一棵B+树包含根节点，内部节点和叶子节点。只有最底层的叶子节点才保存信息，内部节点只是在搜索中用来指引到正确节点的，而且到任何一个叶子节点的最短路径长度都是相同的O\(logn\)。

![](/assets/B+Tree.jpg)  
使用B+树查找特定值的时间复杂度为O\(logn\)，当需要查找两个值之间的多个元素时，通过对叶子节点之间的相连，也使得范围查询更加高效。

如上图，假设查找10到100间的值：

只需要按B+树的最短路径找到10（若10不存在则找10之后最贴近的值）

然后用那些连接来收集10的后续节点，直到找到100

归纳一下，假设需要找M个后续节点，树总共有N个节点，那么这次搜索只需要消耗M+logN。

但对于在数据库中增加或删除一行，B+树需要自我整理和平衡，需要O\(logN\)时间复杂度，所以使用太多的B+索引，减慢了快速插入，更新，删除表中一行的操作速度。

# Hash索引

Hash索引对特定值的检索效率很高，索引检索一次一般即可定位，不像B+索引需要从根节点到叶子节点，需要O\(logN\)次的IO访问。

但以Mysql为例，查询资料如下表：

| 描述 | innoDB | MyISAM | Memory | Archive |
| :--- | :--- | :--- | :--- | :--- |
| 事务 | 支持事务，行级别锁定 | 不支持，表级别锁定 | 不支持，表级别锁定 | 不支持，表级别锁定 |
| 索引 | B+Tree | B+Tree | B+Tree以及Hash | 不支持 |

对于常用的innoDB以及MyISAM引擎，均不支持Hash索引，因其自身存在的诸多弊端

Hash索引仅仅能满足“=”，“IN”，“<=>”查询，不能使用范围查询

Hash索引无法用来进行数据的排序操作

Hash索引不能利用联合索引键查询，因为计算组合索引，Hash值是将键合并后再一起Hash，不能单独计算Hash值，所以对于联合索引前几个键进行查询时，Hash索引无法被利用

Hash索引计算的Hash值若不够松散，存在大量Hash值相等的情况下，不能避免表扫描，性能也不一定好于B+树

# 有关索引
## 聚集索引
聚集索引决定数据在磁盘上的物理排序，一个表只能有一个聚集索引，一般用primary key（pk 主键）来命名
## 非聚集索引




